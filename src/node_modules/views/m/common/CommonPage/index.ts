import * as tomato from "@po-to/tomato";
import * as tdom from "@po-to/tomato-jquery";
import * as funs from "views/global/common/Funs";
import * as ejs from "ejs";
//import * as xxtao from 'views/global/api/API_xxtao_com';



//import require = require("global/require");

//import * as application from "./application";

//import userInfoModule = require("./userInfo");
//xxtao.init(tomato.load);

$(document).ready(function () {
    let indexCmd = new tomato.Cmd('/index.html','首页',true);
    indexCmd.redo = indexCmd.execute = function(){
        tomato.getVPresenter<tomato.VPresenter>(funs.moduleToUrl('m/Index'), (mod) => {
            tomato.application.appendChild(mod);
            this.success();
        })
    }
    let mainModule = $("#doc").val();
    tomato.setConfig({
        application: new tdom.SinglePageApplication(indexCmd),
        renderer:{renderer:ejs.render}
    });
    if(mainModule){
        if(mainModule.indexOf('DemandDetail')>0){
            mainModule += '?demand='+ window["globalData"].current_demand.id;
        }
        tomato.getVPresenter<tomato.VPresenter>(mainModule,function(mod){
            $("#welcome").remove();
            funs.loadPage(mod);
        });
    }

});


//console.log(tomato.requireJS);